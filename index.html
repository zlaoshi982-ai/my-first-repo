<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NESO â†’ NXPC â†’ äººæ°‘å¸ è®¡ç®—å™¨ï¼ˆæ‰‹åŠ¨æ±‡ç‡ï¼‰</title>
<style>
  :root{
    --bg:#f5f6fa;--card:#ffffff;--text:#2c3e50;--muted:#667085;
    --blue:#1e88e5;--green:#2ecc71;--red:#e74c3c;--line:#e6e8ec;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font:16px/1.5 -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
    display:flex; justify-content:center; align-items:flex-start; min-height:100vh;
  }
  .wrap{width:100%; max-width:520px; padding:20px}
  .card{
    background:var(--card); border:1px solid var(--line); border-radius:14px;
    box-shadow:0 6px 18px rgba(0,0,0,.06); padding:22px;
  }
  h1{font-size:20px; margin:0 0 6px}
  .sub{color:var(--muted); font-size:13px; margin-bottom:16px}
  label{display:block; font-weight:600; margin:14px 0 6px}
  input[type="number"], input[type="text"]{
    width:100%; padding:12px 12px; border:1px solid var(--line); border-radius:10px; outline:none;
    background:#fff; color:var(--text); font-size:16px;
  }
  input:focus{border-color:var(--blue)}
  .row{display:flex; gap:10px}
  .row .col{flex:1}
  .help{font-size:12px; color:var(--muted); margin-top:6px}
  .err{color:var(--red); font-size:12px; margin-top:6px; display:none}
  .btn{
    width:100%; padding:12px; border:1px solid var(--line); background:#fff; border-radius:10px;
    cursor:pointer; font-weight:600;
  }
  .btn.primary{background:var(--blue); color:#fff; border-color:var(--blue)}
  .btn.ghost{background:#fff}
  .btn:active{transform:translateY(1px)}
  .actions{display:flex; gap:10px; margin-top:12px}
  .result{
    margin-top:18px; padding:16px; border:1px dashed var(--line); border-radius:12px; background:#fafbfc;
    animation:fade .25s ease;
  }
  .line{margin:6px 0}
  .nxpc{color:var(--blue); font-weight:700}
  .rmb{color:var(--green); font-weight:700}
  .mono{font-variant-numeric:tabular-nums}
  .foot{margin-top:10px; font-size:12px; color:var(--muted); text-align:center}
  .switch{display:flex; align-items:center; gap:8px; margin-top:8px; font-size:13px; color:var(--muted)}
  .switch input{width:18px; height:18px}
  details{
    margin-top:12px; border-top:1px solid var(--line); padding-top:12px
  }
  details summary{cursor:pointer; color:var(--muted)}
  @keyframes fade{from{opacity:.2; transform:translateY(4px)} to{opacity:1; transform:none}}
  @media (max-width:420px){ .row{flex-direction:column} }
  .toast{
    position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
    background:#111; color:#fff; padding:8px 12px; border-radius:8px; font-size:12px; opacity:0; pointer-events:none;
    transition:opacity .2s ease;
  }
  .toast.show{opacity:.95}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>NESO å…‘æ¢è®¡ç®—å™¨</h1>
    <div class="sub">å›ºå®šè§„åˆ™ï¼š<b>100,000 NESO = 1 NXPC</b> Â· åªç”¨æ‰‹åŠ¨æ±‡ç‡ï¼Œç¦»çº¿å¯ç”¨</div>

    <label for="neso">ğŸ”¹ è¾“å…¥ NESO æ•°é‡</label>
    <input id="neso" type="number" inputmode="numeric" placeholder="ä¾‹å¦‚ 1000000ï¼ˆæ”¯æŒå›è½¦è®¡ç®—ï¼‰">
    <div id="eNeso" class="err">è¯·è¾“å…¥ &gt; 0 çš„ NESO æ•°é‡</div>

    <div class="row">
      <div class="col">
        <label for="rate">ğŸª™ 1 NXPC = ? RMBï¼ˆæ‰‹åŠ¨æ±‡ç‡ï¼‰</label>
        <input id="rate" type="number" step="0.0001" placeholder="ä¾‹å¦‚ 5.65ï¼ˆè‡ªåŠ¨è®°å¿†ï¼‰">
        <div id="eRate" class="err">è¯·è¾“å…¥ &gt; 0 çš„æ±‡ç‡</div>
        <div class="help">ä¸Šæ¬¡ä½¿ç”¨ä¼šè‡ªåŠ¨è®°ä½ï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰</div>
      </div>
      <div class="col">
        <label for="ratio">æ¯”ä¾‹ï¼ˆå¯é€‰ï¼‰</label>
        <input id="ratio" type="number" step="1" placeholder="é»˜è®¤ 100000">
        <div class="help">æœªæ¥è§„åˆ™è‹¥å˜ï¼Œå¯è‡ªå®šä¹‰ NESO/æ¯ NXPC</div>
      </div>
    </div>

    <div class="switch">
      <input id="live" type="checkbox">
      <label for="live">å®æ—¶è®¡ç®—ï¼ˆè¾“å…¥æ—¶è‡ªåŠ¨æ›´æ–°ï¼‰</label>
    </div>

    <div class="actions">
      <button id="btnCalc" class="btn primary">è®¡ç®—</button>
      <button id="btnClear" class="btn ghost">æ¸…é™¤</button>
      <button id="btnCopy" class="btn ghost">å¤åˆ¶ç»“æœ</button>
    </div>

    <div id="res" class="result" style="display:none">
      <div class="line mono" id="l1">â€”</div>
      <div class="line mono" id="l2">â€”</div>
      <div class="line mono" id="l3">â€”</div>
    </div>

    <div class="foot">æç¤ºï¼šæŒ‰ <b>Enter/å›è½¦</b> ä¹Ÿå¯è§¦å‘è®¡ç®—</div>
  </div>
</div>

<div id="toast" class="toast">å·²å¤åˆ¶</div>

<script>
  // --------- å·¥å…·å‡½æ•° ---------
  const $   = s => document.querySelector(s);
  const fmt = n => n.toLocaleString('zh-CN');
  const cut = (n, d=4) => Number.isFinite(n) ? n.toFixed(d) : 'â€”';
  const show = (el, on=true)=> el.style.display = on ? '' : 'none';

  // --------- å…ƒç´  ---------
  const elNeso  = $('#neso');
  const elRate  = $('#rate');
  const elRatio = $('#ratio');
  const elLive  = $('#live');
  const eNeso   = $('#eNeso');
  const eRate   = $('#eRate');
  const btnCalc = $('#btnCalc');
  const btnClear= $('#btnClear');
  const btnCopy = $('#btnCopy');
  const boxRes  = $('#res');
  const l1 = $('#l1'), l2 = $('#l2'), l3 = $('#l3');
  const toast = $('#toast');

  // --------- åˆå§‹åŒ–ï¼ˆä»æœ¬åœ°æ¢å¤è®¾ç½®ï¼‰ ---------
  (function init(){
    const savedRate  = localStorage.getItem('nxpc_rate');
    const savedRatio = localStorage.getItem('nxpc_ratio');
    const savedLive  = localStorage.getItem('nxpc_live');

    if (savedRate)  elRate.value  = savedRate;
    if (savedRatio && Number(savedRatio) > 0) elRatio.value = savedRatio;
    elLive.checked = savedLive === '1';

    // å›è½¦è®¡ç®—
    document.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter') { e.preventDefault(); calculate(); }
    });

    // å®æ—¶è®¡ç®—
    elNeso.addEventListener('input', maybeLive);
    elRate.addEventListener('input', ()=>{ localStorage.setItem('nxpc_rate', elRate.value || ''); maybeLive(); });
    elRatio.addEventListener('input', ()=>{ localStorage.setItem('nxpc_ratio', elRatio.value || ''); maybeLive(); });
    elLive.addEventListener('change', ()=> localStorage.setItem('nxpc_live', elLive.checked ? '1' : '0'));

    btnCalc.addEventListener('click', calculate);
    btnClear.addEventListener('click', clearAll);
    btnCopy.addEventListener('click', copyRes);
  })();

  function maybeLive(){ if(elLive.checked) calculate(false); }

  // --------- è®¡ç®—æ ¸å¿ƒ ---------
  function calculate(showErrors = true){
    const neso  = Number(elNeso.value);
    const rate  = Number(elRate.value);
    const ratio = Number(elRatio.value) > 0 ? Number(elRatio.value) : 100000; // é»˜è®¤å›ºå®šæ¯”ä¾‹

    // æ ¡éªŒ
    let ok = true;
    if (!(neso > 0)){ ok=false; if(showErrors){ eNeso.style.display='block'; } }
    else eNeso.style.display='none';

    if (!(rate > 0)){ ok=false; if(showErrors){ eRate.style.display='block'; } }
    else eRate.style.display='none';

    if (!ok) { show(boxRes, false); return; }

    // è®¡ç®—
    const nxpc = neso / ratio;
    const rmb  = nxpc * rate;

    // æ¸²æŸ“
    l1.innerHTML = `ğŸ”¹ <b>${fmt(neso)}</b> NESO`;
    l2.innerHTML = `= <span class="nxpc">${cut(nxpc, 6)} NXPC</span>`;
    l3.innerHTML = `â‰ˆ <span class="rmb">${cut(rmb, 2)} RMB</span>  <span class="help">(æŒ‰æ‰‹åŠ¨æ±‡ç‡ï¼š1 NXPC = ${cut(rate,4)} RMB)</span>`;
    show(boxRes, true);
  }

  // --------- æ¸…é™¤ä¸å¤åˆ¶ ---------
  function clearAll(){
    elNeso.value = '';
    // ä¿ç•™ä¸Šæ¬¡æ±‡ç‡ï¼Œæ–¹ä¾¿å¤ç”¨ï¼›æ¯”ä¾‹ä¹Ÿä¿ç•™
    eNeso.style.display='none';
    eRate.style.display='none';
    show(boxRes, false);
  }

  function copyRes(){
    const txt = boxRes.style.display==='none'
      ? 'æš‚æ— å¯å¤åˆ¶çš„ç»“æœ'
      : `${l1.innerText}\n${l2.innerText}\n${l3.innerText}`;
    navigator.clipboard.writeText(txt).then(()=> showToast('ç»“æœå·²å¤åˆ¶'))
      .catch(()=> showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶'));
  }

  function showToast(msg){
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(()=> toast.classList.remove('show'), 1400);
  }
</script>
</body>
</html>